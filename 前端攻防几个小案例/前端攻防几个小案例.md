

# å‰ç«¯æ”»é˜²å‡ ä¸ªå°æ¡ˆä¾‹

ä¿—è¯è¯´å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œè®°å½•ä¸€äº›å¹³æ—¶æµ‹è¯•çš„æ¡ˆä¾‹ï¼Œçœçš„ä¸‹æ¬¡é‡åˆ°å†é‡æ–°æ‘¸ç´¢

info

å…³é”®ä¿¡æ¯å‡å·²æ‰“ç ï¼Œæ¼æ´å‡å·²æäº¤ç›¸å…³ src ä¿®å¤

- - -

# [](#%E7%99%BB%E9%99%86%E7%82%B91)ç™»é™†ç‚¹ 1

å¸¸è§„å‰ç«¯åŠ å¯†ï¼Œf12 æ‰¾ password åŠ å¯† JS ä»£ç æ¥è¿›è¡Œä¸€ä¸ªçˆ†ç ´

[![](assets/1710207760-31f1bed51dcd2011f39ed173e492df9c.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/10.png)

è¿™é‡Œæ˜¯ password çš„å…³é”®ç®—æ³•ä»£ç ï¼Œå¯ä»¥çœ‹å‡ºè¯¥ keyï¼ŒçŒœæµ‹æ˜¯ç”¨äº† des åŠ å¯†

å¯»æ‰¾ password å¤šæ–­ç‚¹ï¼Œç„¶ååœ¨ç™»å½•æ¡†è¾“å…¥å¯†ç 

[![](assets/1710207760-c7c4a11528ea82d09d22d86f397f3482.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/14.png)

è¿›å…¥è°ƒè¯•çŠ¶æ€ï¼Œä¸€æ­¥æ­¥è°ƒè¯•åˆ°åŠ å¯†ç®—æ³•è¿™ä¸€æ­¥

ä¸éš¾çŒœå‡ºï¼Œs æ˜¯åŠ å¯†åçš„ç»“æœï¼Œ`object(l["a"])` æ˜¯åŠ å¯†å‡½æ•°ï¼Œe.loginform.password æ˜¯è¾“å…¥çš„å¯†ç ï¼Œåé¢å°±æ˜¯ key å€¼ã€‚

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ª js ä»£ç æµ‹è¯•ï¼Œè¾“å…¥çš„å¯†ç ä¸º jfhack

|     |     |     |
| --- | --- | --- |
| ```bash<br>1<br>``` | ```js<br>let jiami = Object(l["a"])("jfhack", "6c81d5508f6578f7a6071e70");console.log(jiami);<br>``` |

æ§åˆ¶å°è°ƒç”¨åŠ å¯†å‡½æ•°æµ‹è¯•

[![](assets/1710207760-9bdd8eefa3a9befd08f5df9a5068d023.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/12.png)

ç”¨ cyberchef æµ‹è¯•

[![](assets/1710207760-628edd31615a272c5e4ca058425f2af4.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/13.png)

å¯ä»¥çœ‹åˆ°åŠ å¯†æ˜¯ä¸€è‡´çš„ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥æ§åˆ¶å°ç”¨ js æ¥ç”Ÿæˆå­—å…¸

|     |     |     |
| --- | --- | --- |
| ```bash<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>``` | ```js<br>let iii = 0;<br>let passdic = new Array();<br>passdic = ['123456','000000','88888']  // è¿™é‡Œå†™å­—å…¸<br>for (iii=0;iii<passdic.length;iii++){<br>    let jiami = Object(l["a"])(passdic[iii], "6c81d5508f6578f7a6071e70");<br>    console.log(jiami);<br>}<br>``` |

- - -

# [](#%E7%99%BB%E9%99%86%E7%82%B92)ç™»é™†ç‚¹ 2

é‡åˆ°å¦å¤–ä¸€ä¸ªç³»ç»Ÿï¼Œå¯†ç ä¹ŸåŠ å¯†äº†ï¼Œä½†å¯†ç å¥½åƒåŠ å…¥äº†æ—¶é—´ç®—æ³•ä¼šä¸€ç›´å˜åŒ–ã€‚

[![](assets/1710207760-85da4e99f801afbca34fd5b0baf77bbe.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/15.png)

[![](assets/1710207760-b62b90da21ab759a8355edc9c474c90c.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/16.png)

å…³é”®ä»£ç æ˜¯ï¼š

|     |     |     |
| --- | --- | --- |
| ```bash<br>1<br>``` | ```js<br>data.password = common.encryptPassword(data.password);<br>``` |

äºæ˜¯ç¼–å†™äº†å¦‚ä¸‹ JS ä»£ç 

|     |     |     |
| --- | --- | --- |
| ```bash<br>1<br>``` | ```js<br>let jiami =common.encryptPassword('123');jiami<br>``` |

[![](assets/1710207760-1b0b64b3faa81ddbfa7ab615fb2f3147.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/17.png)

å¯ä»¥çœ‹åˆ° å¤šæ¬¡è¾“å‡ºä¸€æ ·çš„åŸç”Ÿå¯†ç ï¼ŒåŠ å¯†åçš„å¯†ç æ˜¯ä¸€ç›´åœ¨å˜åŒ–

åé¢æœ‰æœ‹å‹æç¤ºæ€è·¯ï¼Œå¯ä»¥ç¼–å†™ JS è§¦å‘å‘åŒ…ï¼Œæ— éœ€å†™ç”Ÿæˆå­—å…¸çš„ JS ä»£ç ï¼Œè¿™ä¸ªè¦æ ¹æ®ç›®æ ‡ç™»å½•éƒ¨åˆ†çš„ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œå‚è€ƒä»£ç å¦‚ä¸‹ï¼š

|     |     |     |
| --- | --- | --- |
| ```bash<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>``` | ```js<br>const array1 = ['a', 'b', 'c'];<br><br>array1.forEach(element => {<br>    // console.log(element)<br>    e.loginForm.password = element<br>    e.$store.dispatch("user/login" , e.loginForm)<br>});<br>``` |

- - -

# [](#jsrpc-%E7%BB%83%E6%89%8B%E6%A1%88%E4%BE%8B)jsrpc ç»ƒæ‰‹æ¡ˆä¾‹

çœ‹äº† [https://www.svenbeast.com/post/kn2fEdp4Q/](https://www.svenbeast.com/post/kn2fEdp4Q/) çš„æ¡ˆä¾‹åï¼Œå‘ç° jsrpc å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ»¡è¶³æˆ‘ä»¬ js åŠ å¯†åœºæ™¯çš„ä¸€äº›éœ€æ±‚ï¼Œç„¶åä¾¿æ‰¾äº†ä¸€ä¸ªç«™è¿›è¡Œæµ‹è¯•ã€‚

å…ˆç®€å•æŠ“ä¸ªåŒ…çœ‹ä¸‹å¯†æ–‡

[![](assets/1710207760-5e4dde14d9e08a582da5efeb6dd981b3.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/1.png)

`ec6a6536ca304edf844d1d248a4f08dc`, å» cmd5 åæŸ¥ä¸‹å°±çŸ¥é“äº†æ˜¯ 2 æ¬¡ md5

[![](assets/1710207760-c3ff2513aae15ebe6bdfc23a91344cd9.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/2.png)

è¿™ç§æƒ…å†µä¸€èˆ¬ç›´æ¥åœ¨ burp çš„ intruder æ¨¡å—ä¸­ï¼Œpayload processing è¿›è¡Œå¤„ç†å³å¯

è¿™é‡Œç”¨ jsrpc æ¥ç»ƒæ‰‹ï¼Œå…ˆ f12 æ‰¾ç›¸å…³çš„åŠ å¯†å‡½æ•°

å°æŠ€å·§

-   å…¨å±€æœç´¢ç™»é™†ç‚¹ url
-   å…¨å±€æœç´¢ passwordã€encrypto è¿™ç§å…³é”®è¯

[![](assets/1710207760-5d409bb5f24e50c4a246f5465930d704.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/3.png)

[![](assets/1710207760-359b515720bc07d5dec191a249d80f04.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/4.png)

å…¶å®è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œç›®æ ‡å°±æ˜¯ç›´æ¥è°ƒç”¨çš„ [https://github.com/emn178/js-md5](https://github.com/emn178/js-md5) åº“

ä¸ç®¡ï¼Œè£…ä½œçœ‹ä¸è§ğŸ‘€ï¼Œç°åœ¨ç›®æ ‡æ˜¯é€šè¿‡ jsrpc å®ç°ï¼Œåªè¦æ‰¾åˆ°åŠ å¯†å‡½æ•°å°±è¡Œ

åœ¨æ§åˆ¶å°ï¼Œå¯¹ js ä¸­çš„å‡½æ•°å’Œå€¼è¿›è¡Œè¾“å‡ºï¼Œçœ‹æ˜¯å¦å¯ä»¥å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„ç»“æœ

[![](assets/1710207760-44281413e054a3fd1f1cb977726183d7.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/5.png)

å‚è€ƒé¡¹ç›® issue [https://github.com/jxhczhl/JsRpc/issues/4](https://github.com/jxhczhl/JsRpc/issues/4) ä¸­çš„æ–¹æ³•å¯ä»¥å°†å±€éƒ¨å‡½æ•°æš´éœ²ç»™å…¨å±€ä½¿ç”¨ï¼Œè¿™æ ·å°±ä¸ç”¨å¡åœ¨æ–­ç‚¹ä¸­å»è°ƒç”¨å‡½æ•°äº† (ps: ä¸¾ä¸ªä¾‹ï¼Œæˆ‘è¿™ä¸ªåœºæ™¯æ¯”è¾ƒç®€å•ï¼Œéƒ½ä¸éœ€è¦æ–­ç‚¹)

|     |     |     |
| --- | --- | --- |
| ```bash<br>1<br>2<br>``` | ```fallback<br>window.test = md5<br>test(test('1234'));<br>``` |

[![](assets/1710207760-2e08cfa9980d33cab8ee498472ea325b.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/6.png)

æ­¤æ—¶æ§åˆ¶å°èƒ½æ­£å¸¸è°ƒç”¨åŠ å¯†å‡½æ•°äº†ï¼Œä¹ŸæŠŠç›®æ ‡å‡½æ•°æ”¹ä¸ºå…¨å±€å‡½æ•°äº†ï¼Œæ¥ä¸‹æ¥æ§åˆ¶å°ç›´æ¥å¤åˆ¶ jsenv.js çš„ä»£ç ï¼ŒåŒæ—¶æœ¬åœ°å¯åŠ¨ jsrpc æœåŠ¡ï¼Œè¿æ¥é€šä¿¡

|     |     |     |
| --- | --- | --- |
| ```bash<br>1<br>``` | ```fallback<br>var demo = new Hlclient("ws://127.0.0.1:12080/ws?group=zzz&name=hlg");<br>``` |

åœ¨æ§åˆ¶å°æ³¨å†Œ js æ–¹æ³• é€šè¿‡ä¼ é€’å‡½æ•°åè°ƒç”¨

|     |     |     |
| --- | --- | --- |
| ```bash<br>1<br>2<br>3<br>4<br>5<br>``` | ```js<br>demo.regAction("testtttt", function (resolve,param) {<br>    console.log(param);<br>    var testttt123 = test(test(param));<br>    resolve(testttt123);<br>})<br>``` |

è®¿é—®è¿œç¨‹è°ƒç”¨

|     |     |     |
| --- | --- | --- |
| ```bash<br>1<br>``` | ```fallback<br>http://127.0.0.1:12080/go?group=zzz&name=hlg&action=testtttt&param='1234'<br>``` |

[![](assets/1710207760-e5841f44387223a6a5532838e628642c.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/9.png)

åç»­å¯ä»¥å‚è€ƒæ–‡ç«  [https://www.svenbeast.com/post/kn2fEdp4Q/](https://www.svenbeast.com/post/kn2fEdp4Q/) ä¸­çš„æ–¹æ¡ˆï¼Œé€šè¿‡æœ¬åœ° mitm è‡ªåŠ¨æ›¿æ¢ payload, è¿›è¡Œçˆ†ç ´

**èƒ½ä¸èƒ½åœ¨æ§åˆ¶å°ç›´æ¥è§¦å‘å‘åŒ…**

å½“ç„¶å¯ä»¥ï¼Œå°†ç›®æ ‡å‘é€è¯·æ±‚çš„éƒ¨åˆ†ä¿®æ”¹ååœ¨æ§åˆ¶å°æ‰§è¡Œå³å¯

|     |     |     |
| --- | --- | --- |
| ```bash<br>1<br>``` | ```js<br>axios.post("/******/login", {name: "admin",password: test(test('1234'))})<br>``` |

[![](assets/1710207760-ee5944000bca2059193f36d08c2feace.png)](https://r0fus0d.blog.ffffffff0x.com/img/js-case/19.png)
